"use strict";!function(a,b){function c(){return"content"in document.createElement("template")}var d={$el:b("#fkURLForm"),$inputEl:b("#productPageURL"),oldURL:null,handleURLInputClick:function(a){b(a.target).select()},handleURLInputPaste:function(f){"submit"===f.type&&f.preventDefault();var g,h;setTimeout(function(){var f=b.trim(d.$inputEl.val()),i=document.querySelector("#response-container");f.indexOf("flipkart.com")<0&&c()&&(g=document.querySelector("#illegalSeller"),h=document.importNode(g.content,!0),i.innerHTML="",i.appendChild(h)),f.indexOf("flipkart.com")>0&&f!==d.oldURL&&(d.oldURL=f,d.$inputEl.attr("disabled","disabled"),c()&&(g=document.querySelector("#loader"),h=document.importNode(g.content,!0),i.innerHTML="",i.appendChild(h)),b.getJSON("/inputurl",{url:f},function(j){if(!j.price)return void(c()&&(g=document.querySelector("#illegalProductPage"),h=document.importNode(g.content,!0),i.innerHTML="",i.appendChild(h),d.$inputEl.removeAttr("disabled").click()));d.$inputEl.removeAttr("disabled");var k=j.price,l=j.name,m=j.image;if(c()){g=document.querySelector("#tmplNotifyMe");var n=g.content,o=n.querySelector("#product-title"),p=n.querySelector("#product-price"),q=n.querySelector("#product-image"),r=n.querySelector("#productURL"),s=n.querySelector("#currentPrice"),t=n.querySelector("#productName"),u=n.querySelector("#productImage");o.textContent=l,p.textContent=k,q.src=m,q.alt=l,r.value=f,t.value=l,s.value=k,u.value=m,h=document.importNode(g.content,!0),i.innerHTML="",i.appendChild(h);var v=b("#inputEmail");if("localStorage"in a){var w=localStorage.getItem("userEmail");w&&v.val(w)}v.focus(),b(e.el).on("submit",e.handleFormSubmit),b(e.reloadBtn).on("click",e.resetState)}}))}.bind(this),0)}},e={el:"#fkSubmissionForm",reloadBtn:"#reloadBtn",handleFormSubmit:function(a){a.preventDefault();var c=b(this).serialize(),d=b("#inputEmail"),f=b("#submitBtn"),g=b("#reloadBtn"),h=b("#queueResponse"),i=d.val();f.attr("disabled","disabled"),e.saveEmailLocally(i),b.getJSON("/queue",c,function(a){var b=a.status;d.attr("disabled","disabled"),f.hide(),g.removeClass("hide"),h.removeClass("hide").hide().find(".js-queue-response").html(b).end().fadeIn()})},saveEmailLocally:function(b){"localStorage"in a&&localStorage.setItem("userEmail",b)},resetState:function(){location.reload()}};d.$el.on("submit",d.handleURLInputPaste),d.$inputEl.on("paste",d.handleURLInputPaste),d.$inputEl.on("click",d.handleURLInputClick)}(window,jQuery);